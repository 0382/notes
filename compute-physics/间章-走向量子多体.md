# 间章——走向量子多体

之前我们从一维薛定谔方程走向三维，计算了各种我们在课本上出现过或没有出现过的体系。这些体系都是单粒子体系。读者们不难发现，尽管我们对这些体系做了各种各样的处理，为了计算而不得不引入某些近似，但是我们对于单体系统的计算，从理论上来说都是非常完美的。

构建基矢，将哈密顿量这一线性算符表示在这组基上，然后将其对角化。没有比这更正确的求解定态量子体系的算法了。

我们想愿意点进这里的读者们应该都学过微扰论。除了在某些简化模型中发挥一些作用，我们应该不难意识到，微扰论应该也是非常适合用于计算的一种理论。但是在之前的文章中，微扰论却从来没有出现过。这是因为，对于单体系统的数值计算来说，我们没必要在理论上引入近似，我们有足够的能力直接处理精确的哈密顿量。我们引入的近似，都只是数值上妥协，比如我们显然无法处理无限大的基矢空间。

在单体量子体系的计算中，为了提高计算的精度。我们仅需要增加基矢的数目（或者增加离散点的数目），对此的计算复杂度顶多是$O(n^3)$（矩阵对角化的复杂度）。但是当我们走向量子多体系统时，将会发现之前美好的理论变得不再那么美好。简单对角化的计算复杂度变得不可接受，为此我们不得不做出理论上的妥协。

## 多体波函数

考虑一个$N$粒子体系的定态薛定谔方程，其形式不外乎
$$
H(\vec{p}_1, \vec{p}_2, \dots, \vec{p}_N, \vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)\Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N) = E \Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)
$$
波函数在坐标空间的维度是$3N$，对其的数值处理将会变得极为困难。

平均场理论通常喜欢假定这个$3N$维的波函数具有如下形式
$$
\Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N) = \dfrac{1}{\sqrt{N!}}\left|\begin{matrix}
    \psi_1(\vec{r}_1) & \psi_1(\vec{r}_2) & \cdots & \psi_1(\vec{r}_N) \\ 
    \psi_2(\vec{r}_1) & \psi_2(\vec{r}_2) & \cdots & \psi_2(\vec{r}_N) \\ 
    \vdots & \vdots & \ddots & \vdots \\
    \psi_N(\vec{r}_1) & \psi_N(\vec{r}_2) & \cdots & \psi_N(\vec{r}_N) \\ 
\end{matrix}\right|
$$
由此可以将多体的薛定谔方程转换为单体的形式，由此大大减少计算量。这种假设并不是自然的。尽管从某种物理直觉，我们感觉平均场似乎是一个不错的近似，但是想要得到完全无关联的准粒子显然是不可能的。这也是为什么，Hartree-Fock方法仅仅是一种近似理论。除了这种简单的构造方式外，诸如BCS波函数等等，也是对波函数做了某种便于约化的假设。

实际上，除了玻色子交换对称性或者费米子交换反对称性以及像宇称守恒之类的一些基本对称性之外，我们不能对这个巨大无比的波函数$\Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)$做任何假设。而这正是量子多体问题的困难所在。

## 多体薛定谔方程的基矢展开

从坐标空间求解这个多体薛定谔方程看起来希望渺茫，那么是否将其展开到某个基矢空间内？实际上，**二次量子化**所做的正是这么一件事情。

二次量子化给不同粒子数的哈密顿量构造了一个统一的形式，揭示了其中潜藏的对称性，是非常重要的理论。但是从计算的视角来看，二次量子化这个理论体系，给出了构造多体波函数基矢的方法：从单粒子基矢出发构造的一系列Slater行列式（费米子）或者积和式（玻色子）实际上就是多体波函数的基矢。

这一点非常重要，也是现在的大部分ab-initio计算方法的出发点之一。

实际上，直接将多体薛定谔方程在上述基矢上展开，然后直接对角化，就是量子多体计算的方法之一，名为**全组态相互作用** (Full Configuration Interaction)，多体基或者说Slater行列式也被称为组态 (Configuration)。有些人也将这种方法称为精确对角化方法。

不过基矢展开的问题也是非常显然且非常严重的。考虑我们的单粒子基矢取了（截断到）$M$条轨道，而体系粒子数为$N$，不考虑各种对称性，那么费米子可以构建出的多体基总共有
$$
\begin{pmatrix} M \\ N \end{pmatrix}
$$
这么多。如果$N << M$，大致上有$\begin{pmatrix} M \\ N \end{pmatrix} \propto M^N / M!$，即这个数目随粒子数$N$是指数增长的，随着基矢数$M$的增加也是很高阶的多项式。这还仅仅是基矢数目，哈密顿量矩阵元的数目则是基矢数目的平方。

如果像Hartree-Fock那样在单粒子水平上做矩阵运算，那么单粒子基取$M = 1000$条轨道，也不过是一百万个矩阵元，家用笔记本处理起来也绰绰有余。但是如果采用FCI方法，只取$M = 100$条轨道处理$N = 20$个粒子，组态数目就达到了$\begin{pmatrix} 100 \\ 20\end{pmatrix} \approx 5.4\times 10^{20}$，这显然不是我们现在的计算机能够处理的。

## 近似理论的引入

FCI的计算在大体系上变得不太可能。为此，我们不得不引入某种近似。说到底，现有的各种多体计算方法，都是对于我们无法处理这个巨大无比的波函数$\Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)$，或者无法处理其巨大无比的基矢维度而不得不采取的某种妥协。

目前的量子多体计算方法，大致上可以分为三个派系。

### 平均场

以密度泛函理论（Density Functional Theory）为代表的平均场方法。DFT的理论出发点主要就是Hohenberg-Kohn定理，而现行的计算出发点主要是Kohn-Sham（孔恩——沈吕九）方程。

但是正如我们前面所说的，Kohn-Sham方程假定了波函数的形式，但是实际的$3N$维波函数不应该具有这样的形式。DFT试图通过虚拟的平均场来计算出一个虚拟的波函数，但是能够得到合理的可观测量，这充满了某种玄学的味道。DFT中被拟合出来的泛函五花八门，但是很多仅在特定的情况下才表现很好。

实际上，根据Hohenberg-Kohn定理，我们或许可以直接迭代密度而不是通过Kohn-Sham方程迭代单粒子波函数。这种方式看起来会更加自洽，现在也有一些相关的研究，不过泛函从哪里来依然是个问题。

### Post Hartree-Fock

所谓的**后**Hartree-Fock方法，顾名思义就是Hartree-Fock的基础上进一步计算。多体微扰理论通常将Hartree-Fock近似视为一阶近似，在此基础上进一步计算更高阶的微扰，就是其中一种Post Hartree-Fock方法。

另外一种常见的方法是截断的组态相互作用（truncated CI），它可以帮助我们建立一个对Post Hartree-Fock的较为直观的理解。通常Hartree-Fock假定$3N$维的波函数可以写为一个Slater行列式，经过Hartree-Fock计算之后，我们得到了一系列的单粒子能级，这也可以认为是一组较好的单粒子基。使用这组单粒子基可以构建多体组态，真实的波函数可以在看做这些组态的线性组合，而Hartree-Fock方法只取了其中能量最低的一个组态，这当然是不够精确的。

FCI方法截断单粒子基之后，取了这组基能够组成的所有组态，在此基础上进行精确对角化，但是计算量太大。截断的CI通常可以取Hartree-Fock基态，加上这个Hartree-Fock基态两对（或三对，四对，看计算能力）particle-hole激发以内的组态，在此基础上进行对角化。它显然比Hartree-Fock更进一步。当然除了particle-hole激发之外，对于特定的情况还可以采取一些更加聪明的截断方式，这也是研究方向之一。

截断的CI，截断方式还是过于暴力了，可能效果并不是很好。我们可以假设真实波函数在组态上的展开具有某种特定的形式，或许得到更加合理的近似。Coupled Cluster方法就是这样，它假设基态波函数具有形式
$$
\psi = e^{\hat{T}} \psi_0
$$
其中，$\psi_0$就是Hartree-Fock基态的组态。对于最常用的CCSD（coupled cluster single and double），激发算符$\hat{T}$为
$$
\hat{T} = \sum_{ia} t^a_i a^\dagger_a a_i + \dfrac{1}{4}\sum_{ijab}t^{ab}_{ij} a^\dagger_a a^\dagger_b a_j a_i
$$
虽然待定的系数仅仅有单粒子和两粒子部分，但是通过指数形式展开后，实际上包含了所有可能的组态。这使得Coupled Cluster方法能够尽可能地使用较少的计算量包含更多的多体关联。

回到多体微扰理论，它也可以从波函数的组态展开上去理解，后面如果写多体微扰的文章，会对此详细讨论。

另外，这些方法尽管从Hartree-Fock基出发看上去更加合理，从其他任何基出发实际上也完全是可以的。由于包含了更多的组态，理论上对于单粒子基的依赖不会很严重。

Post Hartree-Fock方法虽然利用一些聪明的方法，尽可能多的包含了各种组态展开，但是它们毕竟不是FCI，所以必然在理论上就存在着系统性的误差，如何对这些误差进行估计可能是一个非常重要的研究课题。不过经验上，在电子结构计算中，CCSD(T)（以某种方式包含了部分三阶算符的coupled cluster）在大多数体系中几乎和FCI相差无几了。

### 蒙特卡洛方法

除去变分蒙特卡洛（它主要是用蒙卡计算一下高维积分来算能量期望，本体还是变分法）之外，大部分的量子多体蒙特卡洛算法主要是试图去对基态波函数采样。

我们前面提到了，计算机无法直接处理如此巨大的高维波函数，无论是存储还是计算都非常困难。但是蒙特卡洛的采样能力使得我们可以用统计的方式来处理这个波函数并计算可观测量。这个采样，即可以是坐标空间（各种扩散蒙卡方法等），也可以是组态空间（全组态量子蒙卡(FCIQMC)等）。

不过，在采样之前，我们还需要得到基态波函数。几乎所有的量子蒙特卡洛算法都是通过薛定谔方程的虚时演化来得到的。因为
$$
\lim_{\tau \to \infty} e^{-\tau H} \psi(t=0) \propto \Psi_0
$$
它等价于偏微分方程（虚时薛定谔方程）
$$
-\dfrac{\mathrm{d}}{\mathrm{d}\tau}\psi(\tau) = H\psi(\tau)
$$
将这个方程通过Metropolis算法演化一段时间（例如$\ge \dfrac{3\sim 5}{E_1 - E_0}$，因为激发态成分是指数压低的，不用演化到无穷时间），就得到了基态波函数（即达到了所谓的细致平衡）。当然这个基态波函数是采样的，还需要演化一段时间进行采样，就能够通过统计方法计算各种物理量了。

蒙特卡洛算法看上去非常美好，似乎只要加大统计量就能够得到完全精确的结果。实际上并非如此。能够对波函数采样的前提是可以用概率分布来模拟波函数，但实际运用中通常需要一些近似处理。例如坐标空间波函数由于费米子反对称性而存在负数的部分，概率是没有负数的，为此需要引入所谓的固定节点近似（fixed node approximation）来翻转负数部分。

总之，目前各种量子多体的蒙特卡洛算法都有着各自的问题，并没有真正完美地解决量子多体计算的问题。

## 结语

最后，我们希望各位理论家也好，计算家也罢，在沉迷于推进自己的小领域之时，千万不要忘记了我们的出发点：这个巨大无比的薛定谔方程
$$
H(\vec{p}_1, \vec{p}_2, \dots, \vec{p}_N, \vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)\Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N) = E \Psi(\vec{r}_1, \vec{r}_2, \dots, \vec{r}_N)
$$

-------

上述提到的各种方法，后面看我心情和时间，会试着写一些文章来介绍。这篇文章之后会讲讲FCI方法，也就是精确对角化方法的一些计算技巧。