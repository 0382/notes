# 【代码编辑（二）】代码编辑器概述

广义上讲，用于修改文件内容的软件叫**编辑器(editor)**；用于将一个文件按照某种规则转换成另外一种文件的软件叫**编译器(compiler)**；读取文件内容并按照文件内容作出一系列动作的软件叫做**解释器(interpreter)**。中文语境中，总是有人将编辑器和编译器搞混，特此说明一下。

## 文本编辑

编辑，即修改文件内容。对二进制文件的编辑非常复杂，而对文本文件的编辑则比较简单，常用的就是插入，删除，替换等操作。几乎所有的编程语言源文件都是文本文件，因此我们只谈文本编辑。

文本编辑是程序员的基本工作内容，不管程序能不能运行，你首先新建一个程序源文件，然后开始写代码，有可能你需要删掉一些写错的内容，有时会复制粘贴别人的代码。总之你先开始写吧，就算用手的代码，那也是代码。至于代码写好了，怎么运行，是编译运行还是解释运行，那是后面的事情了。**本文只讲编辑过程**。

## 代码编辑器

介绍一下常见的代码编辑器

- [vim](https://www.vim.org/)，源自linux下的字符界面编辑器`vi`，现在即使有GUI移植，也主要是以字符界面操作方式为主。
- [emacs](https://www.gnu.org/software/emacs/)，GNU组织开源的自由编辑器。
- [sublimetext](https://www.sublimetext.com/)，开源编辑器。理论上要花点钱，但是你不花钱，顶多就是时不时提示你一下。
- [vscode](https://code.visualstudio.com/)，微软开发的编辑器。我的主力编辑器，后面的文章中提到的编辑器默认是`vscode`，可能会提到`vim`。
- [atom](https://atom.io/)，[github](https://github.com/)开发的编辑器。现在github被微软收购了，atom和vscode是同一框架的，应该很难超越vscode。
- [notepad++](https://notepad-plus-plus.org/)，台湾人开发的编辑器，作者是个台独分子，曾经在notepad++的发行说明中宣扬台独主张，建议不要用了。

## 代码编辑器的基本功能

以下的一些功能可能并不是所有的编辑器都有，但是基本上要么内置了，要么可以通过插件实现。上述介绍的几个主流编辑器，都有自己的插件管理方式，能够很方便的下载插件。**如果你在写代码时发现某些操作太重复，太笨拙，你应该主动思考和搜索有没有可能编辑器其实有些功能就可以高效的做到这个操作**。大佬们会为了某些高效编辑操作会自己开发插件，我们至少要学会如何去使用。我以下列的这些功能，并不是全部，主要是为了给大家提供一些参照，表明编辑器是可以实现很多事情的。想要具体学习，可以自行搜索“编辑器名称+功能”或“编辑器+编程语言+功能”。一些功能的常用英文也给出了，中文社区搜索结果不合意也可以试着搜索英文材料。

##### 1. 代码高亮(code highlighting)

代码文件都是文本文件，是不包含文字格式信息的。但是所有文字都是白底黑色的代码文件不利于阅读，看起来很累。代码高亮是代码编辑器的拓展，让关键词、变量名、函数名等不同的成分显示不同的颜色，帮助我们快速理解代码的结构。

代码高亮的这些颜色不是代码本身的，而是编辑器显示的时候附加渲染的。通常你可以通过安装不同的主题(theme)来改变这种着色方式，大胆搜索一下“编辑器名称+主题”吧，你会发现很多漂亮的主题。

##### 2. 自动缩进(auto indent)

代码要写的好看，最好同一个层次的代码能够对齐。我们将每一行代码前面的空格叫做缩进，代码编辑器能够在输入回车时，自动给下一行加上缩进，形成自动对齐的效果。很简单也很常用的功能，一般的代码编辑器都内置了，但是如果编辑器没有自动缩进，大概是哪里出了问题，自行搜索解决吧。

##### 3. 代码格式化(format)

使得混乱的代码按照规定的格式重新排布。vscode中，可以使用`Shift+Alt+f`快捷键触发代码格式化。当然也可以自定义格式化的风格，python常用[autopep8](https://pypi.org/project/autopep8/)，c++常用[clang-format](https://clang.llvm.org/docs/ClangFormat.html)。

> 给的两个链接都没啥卵用，直接搜索对应的插件就是了。

##### 4. 代码折叠(fold)

代码折叠是指将某个代码块折叠起来，比如折叠一个函数，一个`for`循环等等。代码折叠将更多的代码放到一个屏幕内，忽略其中的某些细节，更容易理解文件的组织结构。

##### 5. 静态检查(lint)

静态检查主要是在编译或者运行前检查代码的错误。比如，`c/c++`代码漏了分号，`python`的空格和制表符混合等语法错误；找不到头文件，`python`某个包没装所以`import`错误等依赖错误；`fortran`的类型转换，`c/c++`的`unsigned`转`signed`等潜在的错误等。

这些错误不应该在编译或者运行的时候才被发现，因为此时编译器或者解释器会给出很长的复杂的报错信息，很难阅读。如果在写代码的同时就能够发现，会节省很多时间。

##### 6. 代码提示或自动补全(hint | auto complete)

代码编辑器最能够提高效率的功能就是代码提示了。对于长函数名和变量名，只打几个字符就自动给你提示完整，能够极大的加快编码速度，同时还能够防止自己一个字母一个字母打容易打错。

##### 7. 比较(diff)

比较两个文件，并使用高亮显示出两者的区别。

##### 8. 代码片段(snippets)

自定义一些代码片段，并使用一些简单的字符串触发。比如说用`vscode`写fortran时，我自定义`func`触发以下片段

```fortran
function ${1:function_name}(${2:args})
	implicit none
	${0:!wait for code}
end function ${1:function_name}
```

其中`${xxx}`表示等待输入的部分，可以使用`Tab`键跳转。

vscode使用snippets请看[vscode文档](https://code.visualstudio.com/docs/editor/userdefinedsnippets)。

##### 9. 快捷键

代码编辑器所提供的高效编辑快捷键等，对于提高编码速度也是非常有用的。比如快速删除一行，快速复制一行，快速对一块代码注释和解除注释等等。这些需要在实际工作中不断学习。

## 编辑器的一个常用拓展——调试(debug)

调试也是代码编写的一环。调试能够实时监视代码的全部运行过程，看到代码每一步运行的结果，对于定位代码的错误非常有用。调试器(debugger)一般是一个独立的软件，通过与编辑器的通信来将调试结果实时显示在编辑器上。

vscode调试需要一些配置，详细请看[vscode调试文档](https://code.visualstudio.com/docs/editor/debugging)。vim的调试似乎是[vimspector](https://github.com/puremourning/vimspector)插件比较好，我没用过，有空试试。

## 总结

以上是对编辑器的一般讨论，并不涉及具体的软件操作。

对于vim，我的配置文件在[https://github.com/0382/settings](https://github.com/0382/settings)，很辣鸡，且仅适用于vim8以上的版本，仅供参考。

对于vscode，使用其实很简单，对于`c++,python,latex`，插件装上无脑用就是了，对于fortran开发，可以参考我写的[搭建fortran环境](https://zhuanlan.zhihu.com/p/133302241)。特别要提一点的是，vscode可以使用`Remote-SSH`插件远程连接到服务器进行开发，关于ssh的配置请看我写的[ssh配置](https://zhuanlan.zhihu.com/p/142378687)。

课堂上老师让大家使用的`vc++6.0`，`code::blocks`，`pychram`等工具，集成了编辑器，编译器或解释器，调试器等等组件，被称为**集成开发环境(IDE)**。这些工具功能完善（vc++6.0这个辣鸡除外），但是掩盖了代码从编写到运行的全过程，造成了很多误解。

我从编辑器讲起，一方面做科研的很多人是在远程服务器上使用`vim`写代码，用不上集成开发环境；另一方面，学会了编辑器的基本操作，对于集成开发环境的很多按钮点下去实际上发生了什么，会有一个更加清晰的认识，如果想要去学习使用集成开发环境，也会更加容易。
